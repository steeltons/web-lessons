<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<style>
h2, h3, h4 {
text-align: center;
}
code { 
   font-wieght: bold;
}
div {
    width: 80%;
	margin: auto;
}
</style>
</head>
<body>
<div>
	<h2>Вариант 46</h2>
	<h3>Предметная область</h3>
		<p>В гостинице есть несколько номеров. Каждый номер относится к 
определенному типу. Для каждого типа номера определена цена проживания 
за день.</p><p>Номера в гостинице можно забронировать. Для этого гости 
выбирают номер, указывают дату заселения и выселения. Если гость 
приезжает в гостиницу - статус его номера меняется на "Занят", если же 
отменяет бронирование - статус номера становится "Бронирование 
отменено".</p><p>Гости, проживающие в гостинице, могут пользоваться 
дополнительными платными услугами. При этом указывается дата получения 
услуги и сумма за услугу.</p>
	<h4>Логичская модель базы данных</h4>
		<img src="task_files/booking.jpg">
	<h3>Задание 1</h3>
		<p>Вывести информацию о номерах, расположенных на девятом или десятом 
этажах. Указать название номера, название типа номера и цену. Столбцы 
назвать <b>Номер</b>, <b>Тип_номера</b>, <b>Цена</b>&nbsp; соответственно. Информацию отсортировать сначала по возрастанию цены, а затем по названию номера в алфавитном порядке.</p><strong>Пояснение. </strong>По
 названию номера можно определить, на каком этаже он расположен. 
Название номера состоит из 6 символов, первые две цифры после "<strong>-</strong>" обозначают этаж. Например:<p></p><ul><li>Л-<u><strong>01</strong></u>03 - номер располагается на первом этаже;</li><li>П-<u><strong>12</strong></u>01 - номер располагается на двенадцатом этаже.</li></ul>
	<h3>Задание 2</h3>
		<p>Для каждой услуги в гостинице посчитать, сколько раз ее заказывали 
гости. Также вычислить общую сумму денег, которую принесла гостинице 
каждая услуга. Столбцы назвать <b>Услуга</b>, <b>Количество</b> и <b>Сумма</b>. Если услугой не пользовались, то и в столбце <b>Количество</b>, и в столбце <b>Сумма</b>
 вывести число "-". Информацию отсортировать сначала по убыванию 
стоимости, а потом по убыванию количества и, наконец, по названию услуги
 в алфавитном порядке. </p>
	<h3>Задание 3</h3>
		<p>Вывести гостя(ей), который(е) проживали в гостинице за одно 
заселение больше всех по времени. Для каждого из этих гостей указать 
типы номеров, в которых они проживали. Столбцы назвать <b>Номер</b>, <b>Количество_дней</b>, <b>Типы_номеров</b>.  Информацию отсортировать по фамилии гостя в алфавитном порядке.</p>
	<h3>Задание 4</h3>
		<p>Гость <strong>Астахов И.И.</strong>, проживающий в номере <strong>С-0206</strong> с <strong>2021-01-13</strong>, выезжает из гостиницы. Перед заселением он внес депозит в размере <strong>15000</strong> рублей, с которого отчислялись суммы на оплату заказанных им услуг. Создать таблицу <strong>bill</strong>, в которую включить отчет по депозиту для этого клиента. Отчет включает:</p><ul><li>фамилию
 гостя, название номера, дату заселения и дату выселения в одном поле 
(между фамилией гостя и названием номера - пробел, между названием 
номера и датой заселения - пробел, между датой заселения и датой 
выселения символ <strong>/</strong> ), сумма депозита;</li><li>название 
услуги, дата (даты) ее получения в одном поле (между названием и датой -
 пробел, между датами получения услуги, если их несколько, запятая, даты
 отсортировать в алфавитном порядке), затем вывести общую оплату за эту 
услугу;</li><li>в последней строке вычислить остаток на депозите (разница депозита и суммы услуг), указать <strong>Вернуть</strong> и оставшуюся от депозита сумму (если деньги на депозите еще есть), <strong>Доплатить</strong> (если денег на оплату не хватило), <strong>Итого</strong> (если сумма услуг и депозита совпадает).</li></ul><p>Столбцы назвать <b>Вид_платежа</b> и <b>Сумма</b>. Услуги должны быть отсортированы в алфавитном порядке.</p>
	<h3>Задание 5</h3>
		<p>Для каждого месяца <strong>2020</strong> и <strong>2021</strong> года определить наиболее востребованную услугу. Для этого:</p><ol><li>для каждого месяца выбрать услугу, которую заказывали чаще всего;</li><li>если какую-то услугу заказывали одинаково часто, то выбрать ту услугу, средняя стоимость которой выше.</li></ol><p>Столбцы назвать <b>Год</b>, <b>Месяц</b> и <b>Услуга</b>. Информацию отсортировать сначала по возрастанию года, затем по возрастанию номера месяца.</p>
	<p><b>Примечание</b>. Для решения задания № 5 использовать оконные функции.</p>
</div>

</body></html>